{% macro render_sponsor(name, klass) -%}
  {% set node = fragment('2013', name) %}
  {% if node %}
    {% set website = node.properties.get("website") %}
    {% set image_url = node.properties.get("image") %}
    {% set has_content = False and node.properties.get("content") != "false" %}
    {% if has_content %}
      <a data-toggle="modal" href="#{{name}}"><img class="{{klass}}" alt="{{node.title}}" src="{{ image_url }}"></a>
    {% else %}
      <a href="{{website}}"><img class="{{klass}}" alt="{{node.title}}" src="{{ image_url }}"></a>
    {% endif %}
  {% else %}
  {% endif %}
{%- endmacro %}

{% macro render_sponsor_popup(name, klass) -%}
  {% set node = fragment('2013', name) %}
  {% if node %}
    {% set website = node.properties.get("website") %}
    {% set image_url = node.properties.get("image") %}
    {% set has_content = False and node.properties.get("content") != "false" %}
    {% if has_content %}
      <div class="modal fade sponsor-box" id="{{name}}">
        <div class="modal-header">
          <a class="close" data-dismiss="modal">&times;</a>
          <h3>{{node.title}}</h3>
        </div>
        <div class="modal-body">
          {{ node.content }}
        </div>
        <div class="modal-footer">
          <a href="{{website}}" class="btn btn-primary sponsor-exit">Visit {{node.title}}</a>
          <a data-dismiss="modal" class="btn">Close</a>
        </div>
      </div>
    {% endif %}
  {% else %}
  {% endif %}
{%- endmacro %}

{% macro render_sponsor_row(key, prefix, klass) -%}
    {% set root = getnode("2013", "") %}
    {% set names = root.properties.get(key) and root.properties.get(key).split(",") or [] %}
    {% for name in names %}
        {{ render_sponsor(prefix + name, klass) }}
    {% endfor %}
    {% for name in names %}
        {{ render_sponsor_popup(prefix + name, klass) }}
    {% endfor %}    
    <br/>
{%- endmacro %}

{% set talks = {34: {'title': 'Openstack Workshop covering Intro to Basics and Installation', 'speaker': 'Rahul Krishna Upadhyaya', 'url': 'http://in.pycon.org/funnel/2013/34-openstack-workshop-covering-intro-to-basics-and-installation'}, 51: {'title': 'Test your code', 'speaker': 'Ratnadeep Debnath', 'url': 'http://in.pycon.org/funnel/2013/51-test-your-code'}, 4: {'title': 'Document your code (Sphinx workshop)', 'speaker': 'Kushal Das', 'url': 'http://in.pycon.org/funnel/2013/4-document-your-code-sphinx-workshop'}, 5: {'title': 'Functional Testing Using Selenium', 'speaker': 'Baiju Muthukadan', 'url': 'http://in.pycon.org/funnel/2013/5-functional-testing-using-selenium'}, 23: {'title': 'Idiomatic Programming - Getting the best out of your Python code', 'speaker': 'Anand B Pillai', 'url': 'http://in.pycon.org/funnel/2013/23-idiomatic-programming-getting-the-best-out-of-your-python-code'}, 72: {'title': 'Advanced data analysis with Pandas', 'speaker': 'Anand S', 'url': 'http://in.pycon.org/funnel/2013/72-advanced-data-analysis-with-pandas'}, 31: {'title': 'Distributed task processing using Celery', 'speaker': 'Narahari Allamraju', 'url': 'http://in.pycon.org/funnel/2013/31-distributed-task-processing-using-celery'}, 46: {'title': 'Introduction to scikit-learn: Machine Learning in Python', 'speaker': 'Bala Subrahmanyam Varanasi', 'url': 'http://in.pycon.org/funnel/2013/46-introduction-to-scikit-learn-machine-learning-in-python'}, 47: {'title': 'When to Optimize code? Performance and Memory Optimizations in Python.', 'speaker': 'Venkata Ramana', 'url': 'http://in.pycon.org/funnel/2013/47-when-to-optimize-code-performance-and-memory-optimizations-in-python'}} %}

{% macro render_talk(id) -%}
    {% set talk = talks[id] %}
    <a class="title" href="{{talk['url']}}">{{ talk['title'] }}</a><br/>
    <a class="speaker" href="{{talk['url']}}">{{ talk['speaker'] }}</a>
{%- endmacro %}
